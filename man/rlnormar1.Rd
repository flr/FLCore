% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/oem.R
\name{rlnormar1}
\alias{rlnormar1}
\title{Generate an AR(1) lognormal FLQuant time-series}
\usage{
rlnormar1(
  n = NULL,
  meanlog = 0,
  sdlog = 1,
  rho = 0,
  years,
  bias.correct = FALSE
)
}
\arguments{
\item{n}{Integer. Number of iterations to generate. If \code{NULL} (default)
\code{n} is set to the maximum length of \code{meanlog}, \code{sdlog} and \code{rho}.}

\item{meanlog}{Numeric. Mean(s) of the normal (log) distribution for the
innovations. Recycled to length \code{n} if necessary.}

\item{sdlog}{Numeric. Standard deviation(s) of the normal (log)
distribution for the innovations. Recycled to length \code{n} if necessary.}

\item{rho}{Numeric. AR(1) autocorrelation parameter(s) in \link{-1, 1}.
Recycled to length \code{n} if necessary.}

\item{years}{Integer or character vector. Years (time dimension) for the
returned FLQuant (length determines number of time steps).}

\item{bias.correct}{Logical. If TRUE (default FALSE) subtract
0.5 * sdlog^2 from the log-series before exponentiation to correct
for the lognormal bias.}
}
\value{
An object of class FLQuant with dimensions year x iter containing
the simulated log-normal AR(1) series.
}
\description{
Simulate one or more iterated log-normal AR(1) series across specified
years and return the results as an FLQuant.
}
\details{
The function first draws independent normal samples with given
\code{meanlog} and \code{sdlog}, constructs an AR(1) process with correlation
parameter \code{rho}, and finally exponentiates the series. If
\code{bias.correct = TRUE} the log-normal bias (0.5 * sdlog^2) is removed
on the log-scale so that the resulting series have the requested
\code{meanlog} on the log-scale.

The simulation proceeds as follows:
\enumerate{
\item Draw independent normal innovations: eps_{t,i} ~ N(meanlog_i, sdlog_i^2).
\item Build the AR(1) process: x_{t,i} = rho_i * x_{t-1,i} + sqrt(1 - rho_i^2) * eps_{t,i},
with x_{1,i} = eps_{1,i}.
\item Optionally apply bias correction on the log scale, then exponentiate:
y_{t,i} = exp(x_{t,i} - 0.5 * sdlog_i^2)  (if bias.correct = TRUE).
}
}
\examples{
# 6 years, 5 iterations, rho = 0.5, default meanlog/sdlog
rlnormar1(n = 5, rho = 0.5, years = 2000:2005)

# varying sdlog per iteration
rlnormar1(n = 3, sdlog = c(0.5, 1, 1.5), rho = 0.3, years = 1990:1994)

}
\references{
Thorson, J. T. Predicting recruitment density dependence and intrinsic growth rate for all fishes worldwide using a data-integrated life-history model. Fish Fish. 2020; 21: 237â€“ 251. https://doi-org.ezproxy.library.wur.nl/10.1111/faf.12427
}
\seealso{
\link{rlnorm}
}
\author{
Iago Mosqueira (WMR), Henning Winker (JRC).
}
\keyword{statistics}
